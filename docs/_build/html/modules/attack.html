<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>greatx.attack &mdash; GREATX 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="greatx.defense" href="defense.html" />
    <link rel="prev" title="greatx.dataset" href="dataset.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GREATX
            <img src="../_static/greatx.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="root.html">greatx</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">greatx.dataset</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">greatx.attack</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#base-classes">Base Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#targeted-attacks">Targeted Attacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#untargeted-attacks">Untargeted Attacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#injection-attacks">Injection Attacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#backdoor-attacks">Backdoor Attacks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="defense.html">greatx.defense</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.html">greatx.nn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nn.html#greatx-nn-layers">greatx.nn.layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn.html#greatx-nn-models">greatx.nn.models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functional.html">greatx.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">greatx.training</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">greatx.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GREATX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>greatx.attack</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/attack.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="greatx-attack">
<h1>greatx.attack<a class="headerlink" href="#greatx-attack" title="Permalink to this heading">¶</a></h1>
<div class="section" id="base-classes">
<h2>Base Classes<a class="headerlink" href="#base-classes" title="Permalink to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Attacker</span></code></a></p></td>
<td><p>Adversarial attacker for graph data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.FlipAttacker" title="greatx.attack.FlipAttacker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FlipAttacker</span></code></a></p></td>
<td><p>Adversarial attacker for graph data by flipping edges.</p></td>
</tr>
</tbody>
</table>
<span class="target" id="module-greatx.attack"></span><dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.Attacker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Attacker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/attacker.html#Attacker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.Attacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Adversarial attacker for graph data. Note that this is an abstract class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>For example, the attacker model should be defined as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attacker</span> <span class="kn">import</span> <span class="n">Attacker</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">Attacker</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> <span class="c1"># reset states</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">attack_arguments</span><span class="p">)</span> <span class="c1"># attack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get the attacked graph denoted as PyG-like Data</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.Attacker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/attacker.html#Attacker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.Attacker.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset attacker state.
Override this method in subclass to implement specific function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.Attacker.data">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Data</span></span></span><a class="reference internal" href="../_modules/greatx/attack/attacker.html#Attacker.data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.Attacker.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the attacked graph denoted as PyG-like Data.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.10)"><strong>NotImplementedError</strong></a> – The subclass does not implement this interface.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.Attacker.attack">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.attacker.Attacker"><span class="pre">Attacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/attacker.html#Attacker.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.Attacker.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method.
The subclass must override this method to implement specific attack for itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.10)"><strong>NotImplementedError</strong></a> – The subclass does not implement this interface.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.Attacker.set_max_perturbations">
<span class="sig-name descname"><span class="pre">set_max_perturbations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_perturbations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.attacker.Attacker"><span class="pre">Attacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/attacker.html#Attacker.set_max_perturbations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.Attacker.set_max_perturbations" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the maximum number of allowed perturbations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_perturbations</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the maximum number of allowed perturbations, by default np.inf</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to verbose the operation, by default True</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">set_max_perturbations</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="greatx.attack.Attacker.max_perturbations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_perturbations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#greatx.attack.Attacker.max_perturbations" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum allowable perturbation size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="greatx.attack.Attacker.feat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#greatx.attack.Attacker.feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Node features of the original graph.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="greatx.attack.Attacker.label">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">label</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#greatx.attack.Attacker.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Node labels of the original graph.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="greatx.attack.Attacker.edge_index">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#greatx.attack.Attacker.edge_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Edge index of the original graph.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="greatx.attack.Attacker.edge_weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#greatx.attack.Attacker.edge_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Edge weight of the original graph.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FlipAttacker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Adversarial attacker for graph data by flipping edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#greatx.attack.FlipAttacker" title="greatx.attack.FlipAttacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.FlipAttacker</span></code></a> is a base class for graph modification attacks (GMA).</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.FlipAttacker" title="greatx.attack.flip_attacker.FlipAttacker"><span class="pre">FlipAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset attacker. This method must be called before attack.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.remove_edge">
<span class="sig-name descname"><span class="pre">remove_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.remove_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.remove_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an edge from the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The source node of the edge</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The destination node of the edge</p></li>
<li><p><strong>it</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The iteration that indicates the order of
the edge being removed, by default None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.add_edge">
<span class="sig-name descname"><span class="pre">add_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.add_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one edge to the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The source node of the edge</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The destination node of the edge</p></li>
<li><p><strong>it</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The iteration that indicates the order of
the edge being added, by default None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.removed_edges">
<span class="sig-name descname"><span class="pre">removed_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.removed_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.removed_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the edges to be removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.added_edges">
<span class="sig-name descname"><span class="pre">added_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.added_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.added_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the edges to be added.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.edge_flips">
<span class="sig-name descname"><span class="pre">edge_flips</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="utils.html#greatx.utils.BunchDict" title="greatx.utils.bunchdict.BunchDict"><span class="pre">BunchDict</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.edge_flips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.edge_flips" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the edges to be flipped, including edges to be added and removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.remove_feat">
<span class="sig-name descname"><span class="pre">remove_feat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.remove_feat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.remove_feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the feature in a dimension <cite>v</cite> form a node <cite>u</cite>.
That is, set a dimension of the specific node to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the node whose features are to be removed</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the dimension of the feature to be removed</p></li>
<li><p><strong>it</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The iteration that indicates the order
of the features being removed, by default None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.add_feat">
<span class="sig-name descname"><span class="pre">add_feat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.add_feat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.add_feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the feature in a dimension <cite>v</cite> form a node <cite>u</cite>.
That is, set a dimension of the specific node to one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the node whose features are to be added</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the dimension of the feature to be added</p></li>
<li><p><strong>it</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The iteration that indicates the order
of the features being added, by default None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.removed_feats">
<span class="sig-name descname"><span class="pre">removed_feats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.removed_feats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.removed_feats" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the features to be removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.added_feats">
<span class="sig-name descname"><span class="pre">added_feats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.added_feats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.added_feats" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the features to be added.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.feat_flips">
<span class="sig-name descname"><span class="pre">feat_flips</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="utils.html#greatx.utils.BunchDict" title="greatx.utils.bunchdict.BunchDict"><span class="pre">BunchDict</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.feat_flips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.feat_flips" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the features to be flipped, including features to be added and removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Data</span></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the attacked graph denoted by
PyG-like data instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>symmetric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether the output graph is symmetric, by default True</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the attacked graph denoted by PyG-like data instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.set_allow_singleton">
<span class="sig-name descname"><span class="pre">set_allow_singleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.set_allow_singleton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.set_allow_singleton" title="Permalink to this definition">¶</a></dt>
<dd><p>Set whether the attacked graph allow singleton node, i.e.,
zero degree nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – the flag to set</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">set_allow_singleton</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.set_allow_structure_attack">
<span class="sig-name descname"><span class="pre">set_allow_structure_attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.set_allow_structure_attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.set_allow_structure_attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Set whether the attacker allow attacks on the topology of the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – the flag to set</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">set_allow_structure_attack</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.set_allow_feature_attack">
<span class="sig-name descname"><span class="pre">set_allow_feature_attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.set_allow_feature_attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.set_allow_feature_attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Set whether the attacker allow attacks on the features of nodes in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – the flag to set</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">set_allow_feature_attack</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.is_singleton_edge">
<span class="sig-name descname"><span class="pre">is_singleton_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.is_singleton_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.is_singleton_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the edge is an singleton edge that, if removed,
would result in a singleton node in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The source node of the edge</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The destination node of the edge</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bool</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>True</cite> if the edge is an singleton edge, otherwise <cite>False</cite>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please make sure the edge is the one being removed.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.FlipAttacker.is_legal_edge">
<span class="sig-name descname"><span class="pre">is_legal_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/flip_attacker.html#FlipAttacker.is_legal_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.FlipAttacker.is_legal_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the edge (u,v) is legal.</p>
<p>An edge (u,v) is legal if u!=v and edge (u,v) is not selected before.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The source node of the edge</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The destination node of the edge</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bool</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>True</cite> if the u!=v and edge (u,v), (v,u) is not selected, otherwise <cite>False</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="targeted-attacks">
<h2>Targeted Attacks<a class="headerlink" href="#targeted-attacks" title="Permalink to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.targeted.TargetedAttacker" title="greatx.attack.targeted.TargetedAttacker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TargetedAttacker</span></code></a></p></td>
<td><p>Base class for adversarial targeted attack.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.targeted.RandomAttack" title="greatx.attack.targeted.RandomAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RandomAttack</span></code></a></p></td>
<td><p>Random attacker that randomly chooses edges to flip.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.targeted.DICEAttack" title="greatx.attack.targeted.DICEAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DICEAttack</span></code></a></p></td>
<td><p>Implementation of <cite>DICE</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1608.00375">&quot;Hiding Individuals and Communities in a Social Network&quot;</a> paper</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.targeted.FGAttack" title="greatx.attack.targeted.FGAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FGAttack</span></code></a></p></td>
<td><p>Implementation of <cite>FGA</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1809.02797">&quot;Fast Gradient Attack on Network Embedding&quot;</a> paper (arXiv'18)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.targeted.IGAttack" title="greatx.attack.targeted.IGAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IGAttack</span></code></a></p></td>
<td><p>Implementation of <cite>IG-FGSM</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1903.01610">&quot;Adversarial Examples on Graph Data: Deep Insights into Attack and Defense&quot;</a> paper (IJCAI'19)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.targeted.SGAttack" title="greatx.attack.targeted.SGAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SGAttack</span></code></a></p></td>
<td><p>Implementation of <cite>SGA</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/2009.03488">&quot;Adversarial Attack on Large Scale Graph&quot;</a> paper (TKDE'21)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.targeted.Nettack" title="greatx.attack.targeted.Nettack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Nettack</span></code></a></p></td>
<td><p>Implementation of <cite>Nettack</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1805.07984">&quot;Adversarial Attacks on Neural Networks for Graph Data&quot;</a> paper (KDD'18)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.targeted.GFAttack" title="greatx.attack.targeted.GFAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GFAttack</span></code></a></p></td>
<td><p>Implementation of <cite>GFA</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1908.01297">&quot;A Restricted Black - box Adversarial Framework Towards Attacking Graph Embedding Models&quot;</a> paper (AAAI'20)</p></td>
</tr>
</tbody>
</table>
<span class="target" id="module-greatx.attack.targeted"></span><dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.targeted.TargetedAttacker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TargetedAttacker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/targeted_attacker.html#TargetedAttacker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.TargetedAttacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for adversarial targeted attack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#greatx.attack.targeted.TargetedAttacker" title="greatx.attack.targeted.TargetedAttacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.targeted.TargetedAttacker</span></code></a> is a subclass of
<a class="reference internal" href="#greatx.attack.FlipAttacker" title="greatx.attack.FlipAttacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.FlipAttacker</span></code></a>.
It belongs to graph modification attack (GMA).</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.TargetedAttacker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.targeted.TargetedAttacker" title="greatx.attack.targeted.targeted_attacker.TargetedAttacker"><span class="pre">TargetedAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/targeted/targeted_attacker.html#TargetedAttacker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.TargetedAttacker.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.targeted.TargetedAttacker" title="greatx.attack.targeted.TargetedAttacker">TargetedAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.TargetedAttacker.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_attack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.targeted.TargetedAttacker" title="greatx.attack.targeted.targeted_attacker.TargetedAttacker"><span class="pre">TargetedAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/targeted/targeted_attacker.html#TargetedAttacker.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.TargetedAttacker.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial targeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the target node to be attacked</p></li>
<li><p><strong>target_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the label of the target node.</p></li>
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id1"><span class="problematic" id="id2">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id3"><span class="problematic" id="id4">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>direct_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct direct attack or indirect attack.</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.TargetedAttacker.is_legal_edge">
<span class="sig-name descname"><span class="pre">is_legal_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/targeted/targeted_attacker.html#TargetedAttacker.is_legal_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.TargetedAttacker.is_legal_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the edge (u,v) is legal.</p>
<p>For targeted attacker, an edge (u,v) is legal
if u!=v and edge (u,v) is not selected before.</p>
<p>In addition, if the setting is <cite>indirect attack</cite>,
the targeted node is not allowed to be u or v.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – src node id</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – dst node id</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the u!=v and edge (u,v) is not selected, otherwise False.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.targeted.RandomAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RandomAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/random_attack.html#RandomAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.RandomAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Random attacker that randomly chooses edges to flip.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.targeted</span> <span class="kn">import</span> <span class="n">RandomAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">RandomAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with default budget set as node degree</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_budgets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with budget set as 1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.RandomAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/random_attack.html#RandomAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.RandomAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial targeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the target node to be attacked</p></li>
<li><p><strong>target_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the label of the target node.</p></li>
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id5"><span class="problematic" id="id6">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id7"><span class="problematic" id="id8">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>direct_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct direct attack or indirect attack.</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.RandomAttack.get_added_edge">
<span class="sig-name descname"><span class="pre">get_added_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influence_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/targeted/random_attack.html#RandomAttack.get_added_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.RandomAttack.get_added_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.RandomAttack.get_removed_edge">
<span class="sig-name descname"><span class="pre">get_removed_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influence_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/targeted/random_attack.html#RandomAttack.get_removed_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.RandomAttack.get_removed_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.targeted.DICEAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DICEAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/dice_attack.html#DICEAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.DICEAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>DICE</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1608.00375">“Hiding Individuals and Communities in a Social
Network”</a> paper</p>
<p>DICE randomly chooses edges to flip based on the principle of
“Disconnect Internally, Connect Externally” (DICE),
which conducts attacks by removing edges between nodes
with high correlations and connecting edges with low correlations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.targeted</span> <span class="kn">import</span> <span class="n">IGAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">IGAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with default budget set as node degree</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_budgets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with budget set as 1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.DICEAttack.get_added_edge">
<span class="sig-name descname"><span class="pre">get_added_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influence_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/targeted/dice_attack.html#DICEAttack.get_added_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.DICEAttack.get_added_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.DICEAttack.get_removed_edge">
<span class="sig-name descname"><span class="pre">get_removed_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influence_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/targeted/dice_attack.html#DICEAttack.get_removed_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.DICEAttack.get_removed_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.targeted.FGAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FGAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/fg_attack.html#FGAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.FGAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>FGA</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1809.02797">“Fast Gradient Attack on Network Embedding”</a> paper (arXiv’18)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.targeted</span> <span class="kn">import</span> <span class="n">FGAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">FGAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with default budget set as node degree</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_budgets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with budget set as 1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a simple but effective attack that utilizing gradient information
of the adjacency matrix. There are several work sharing the same heuristic,
we list them as follows:
[1] <cite>FGSM</cite>: <a class="reference external" href="https://arxiv.org/abs/1412.6572">“Explaining and Harnessing Adversarial Examples”</a> paper (ICLR’15)
[2] <a class="reference external" href="https://ieeexplore.ieee.org/abstract/document/9141291">“Link Prediction Adversarial Attack Via Iterative Gradient Attack”</a> paper (IEEE Trans’20)
[3] <a class="reference external" href="https://arxiv.org/abs/1806.02371">“Adversarial Attack on Graph Structured Data”</a> paper (ICML’18)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <a class="reference internal" href="#greatx.attack.targeted.FGAttack.reset" title="greatx.attack.targeted.FGAttack.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.FGAttack.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/fg_attack.html#FGAttack.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.FGAttack.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.targeted.TargetedAttacker" title="greatx.attack.targeted.TargetedAttacker">TargetedAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.FGAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/fg_attack.html#FGAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.FGAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial targeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the target node to be attacked</p></li>
<li><p><strong>target_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the label of the target node.</p></li>
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id11"><span class="problematic" id="id12">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id13"><span class="problematic" id="id14">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>direct_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct direct attack or indirect attack.</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.FGAttack.structure_score">
<span class="sig-name descname"><span class="pre">structure_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/fg_attack.html#FGAttack.structure_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.FGAttack.structure_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.FGAttack.feature_score">
<span class="sig-name descname"><span class="pre">feature_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/fg_attack.html#FGAttack.feature_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.FGAttack.feature_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.FGAttack.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modified_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/fg_attack.html#FGAttack.compute_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.FGAttack.compute_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.targeted.IGAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IGAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/ig_attack.html#IGAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.IGAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>IG-FGSM</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1903.01610">“Adversarial Examples on Graph Data: Deep Insights
into Attack and Defense”</a> paper (IJCAI’19)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.targeted</span> <span class="kn">import</span> <span class="n">IGAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">IGAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with default budget set as node degree</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_budgets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with budget set as 1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.IGAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/ig_attack.html#IGAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.IGAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial targeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the target node to be attacked</p></li>
<li><p><strong>target_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the label of the target node.</p></li>
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id16"><span class="problematic" id="id17">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id18"><span class="problematic" id="id19">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>direct_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct direct attack or indirect attack.</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.IGAttack.get_candidate_edges">
<span class="sig-name descname"><span class="pre">get_candidate_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/ig_attack.html#IGAttack.get_candidate_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.IGAttack.get_candidate_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.IGAttack.get_candidate_features">
<span class="sig-name descname"><span class="pre">get_candidate_features</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/ig_attack.html#IGAttack.get_candidate_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.IGAttack.get_candidate_features" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.IGAttack.get_link_importance">
<span class="sig-name descname"><span class="pre">get_link_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/ig_attack.html#IGAttack.get_link_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.IGAttack.get_link_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.IGAttack.get_feature_importance">
<span class="sig-name descname"><span class="pre">get_feature_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/ig_attack.html#IGAttack.get_feature_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.IGAttack.get_feature_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.IGAttack.compute_structure_gradients">
<span class="sig-name descname"><span class="pre">compute_structure_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/ig_attack.html#IGAttack.compute_structure_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.IGAttack.compute_structure_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.IGAttack.compute_feature_gradients">
<span class="sig-name descname"><span class="pre">compute_feature_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/ig_attack.html#IGAttack.compute_feature_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.IGAttack.compute_feature_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SGAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>SGA</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/2009.03488">“Adversarial Attack on Large Scale Graph”</a> paper (TKDE’21)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.targeted</span> <span class="kn">import</span> <span class="n">SGAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">SGAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with default budget set as node degree</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_budgets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with budget set as 1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><cite>SGAttack</cite> is a scalable attack that can be applied to large scale graphs.</p></li>
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to initialize the (trained) surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>Module</em>) – the input surrogate module</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – temperature used for softmax activation, by default 1.0</p></li>
<li><p><strong>freeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to freeze the model’s parameters to save time, by default True</p></li>
<li><p><strong>required</strong> (<em>Union</em><em>[</em><em>Module</em><em>, </em><em>Tuple</em><em>[</em><em>Module</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – which class(es) of the surrogate model are required, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the class itself</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="root.html#greatx.surrogate.Surrogate" title="greatx.surrogate.Surrogate">Surrogate</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">required</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack.set_normalize">
<span class="sig-name descname"><span class="pre">set_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack.set_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack.set_normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack.strongest_wrong_class">
<span class="sig-name descname"><span class="pre">strongest_wrong_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack.strongest_wrong_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack.strongest_wrong_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack.get_subgraph">
<span class="sig-name descname"><span class="pre">get_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_wrong_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack.get_subgraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack.get_subgraph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack.get_top_attackers">
<span class="sig-name descname"><span class="pre">get_top_attackers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgraph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_wrong_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_attackers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack.get_top_attackers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack.get_top_attackers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack.subgraph_processing">
<span class="sig-name descname"><span class="pre">subgraph_processing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influencers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attacker_nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack.subgraph_processing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack.subgraph_processing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial targeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the target node to be attacked</p></li>
<li><p><strong>target_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the label of the target node.</p></li>
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id21"><span class="problematic" id="id22">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id23"><span class="problematic" id="id24">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>direct_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct direct attack or indirect attack.</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.SGAttack.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgraph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_wrong_label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/sg_attack.html#SGAttack.compute_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.SGAttack.compute_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Nettack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>Nettack</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1805.07984">“Adversarial Attacks on Neural Networks for Graph Data”</a> paper (KDD’18)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.targeted</span> <span class="kn">import</span> <span class="n">Nettack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">Nettack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with default budget set as node degree</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_budgets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with budget set as 1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <a class="reference internal" href="#greatx.attack.targeted.Nettack.reset" title="greatx.attack.targeted.Nettack.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to initialize the (trained) surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>Module</em>) – the input surrogate module</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – temperature used for softmax activation, by default 1.0</p></li>
<li><p><strong>freeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to freeze the model’s parameters to save time, by default True</p></li>
<li><p><strong>required</strong> (<em>Union</em><em>[</em><em>Module</em><em>, </em><em>Tuple</em><em>[</em><em>Module</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – which class(es) of the surrogate model are required, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the class itself</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="root.html#greatx.surrogate.Surrogate" title="greatx.surrogate.Surrogate">Surrogate</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">required</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.targeted.TargetedAttacker" title="greatx.attack.targeted.TargetedAttacker">TargetedAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.compute_cooccurrence_constraint">
<span class="sig-name descname"><span class="pre">compute_cooccurrence_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.compute_cooccurrence_constraint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.compute_cooccurrence_constraint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.gradient_wrt_x">
<span class="sig-name descname"><span class="pre">gradient_wrt_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.gradient_wrt_x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.gradient_wrt_x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.compute_logits">
<span class="sig-name descname"><span class="pre">compute_logits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.compute_logits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.compute_logits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.strongest_wrong_class">
<span class="sig-name descname"><span class="pre">strongest_wrong_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.strongest_wrong_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.strongest_wrong_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.feature_scores">
<span class="sig-name descname"><span class="pre">feature_scores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.feature_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.feature_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.structure_score">
<span class="sig-name descname"><span class="pre">structure_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a_hat_uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XW</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.structure_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.structure_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.compute_XW">
<span class="sig-name descname"><span class="pre">compute_XW</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.compute_XW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.compute_XW" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.get_attacker_nodes">
<span class="sig-name descname"><span class="pre">get_attacker_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_additional_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.get_attacker_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.get_attacker_nodes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.compute_new_a_hat_uv">
<span class="sig-name descname"><span class="pre">compute_new_a_hat_uv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate_edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.compute_new_a_hat_uv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.compute_new_a_hat_uv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.get_candidate_edges">
<span class="sig-name descname"><span class="pre">get_candidate_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_influencers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.get_candidate_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.get_candidate_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.Nettack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_influencers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ll_constraint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ll_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/nettack.html#Nettack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.Nettack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial targeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the target node to be attacked</p></li>
<li><p><strong>target_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the label of the target node.</p></li>
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id26"><span class="problematic" id="id27">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id28"><span class="problematic" id="id29">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>direct_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct direct attack or indirect attack.</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.targeted.GFAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GFAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/gf_attack.html#GFAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.GFAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>GFA</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1908.01297">“A Restricted Black - box Adversarial Framework Towards
Attacking Graph Embedding Models”</a> paper (AAAI’20)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the order of graph filter, by default 2</p></li>
<li><p><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – top-T largest eigen-values/vectors selected, by default 128</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed of reproduce the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <cite>__class__.__name__</cite>, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.targeted</span> <span class="kn">import</span> <span class="n">IGAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">IGAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with default budget set as node degree</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_budgets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># attacking target node `1` with budget set as 1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>In the paper, the authors mainly consider the single edge perturbations, i.e., <code class="xref py py-obj docutils literal notranslate"><span class="pre">num_budgets=1</span></code>.</p></li>
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
<li><p>T=128 for citeseer and pubmed, T=num_nodes//2 for cora to reproduce results in paper.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.GFAttack.get_candidate_edges">
<span class="sig-name descname"><span class="pre">get_candidate_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/gf_attack.html#GFAttack.get_candidate_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.GFAttack.get_candidate_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.GFAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ll_constraint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ll_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/gf_attack.html#GFAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.GFAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial targeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the target node to be attacked</p></li>
<li><p><strong>target_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the label of the target node.</p></li>
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id31"><span class="problematic" id="id32">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id33"><span class="problematic" id="id34">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>direct_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct direct attack or indirect attack.</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.targeted.GFAttack.structure_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">structure_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">csr_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig_vals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig_vec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate_edges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nosum'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/targeted/gf_attack.html#GFAttack.structure_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.targeted.GFAttack.structure_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the score of potential edges as formulated in paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>sp.csr_matrix</em>) – the graph adjacency matrix</p></li>
<li><p><strong>x_mean</strong> (<em>Tensor</em>) – </p></li>
<li><p><strong>eig_vals</strong> (<em>Tensor</em>) – the eigen value</p></li>
<li><p><strong>eig_vec</strong> (<em>Tensor</em>) – the eigen vector</p></li>
<li><p><strong>candidate_edges</strong> (<em>np.ndarray</em>) – the candidate_edges to be selected</p></li>
<li><p><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The order of graph filter K.</p></li>
<li><p><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Selecting the Top-T largest eigen-values/vectors.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – “sum” or “nosum”
Indicates the score are calculated from which loss as in Equation (8) or Equation (12).
“nosum” denotes Equation (8), where the loss is derived from Graph Convolutional Networks,
“sum” denotes Equation (12), where the loss is derived from Sampling-based Graph Embedding Methods.
by default “nosum”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scores for potential edges.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="untargeted-attacks">
<h2>Untargeted Attacks<a class="headerlink" href="#untargeted-attacks" title="Permalink to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.untargeted.UntargetedAttacker" title="greatx.attack.untargeted.UntargetedAttacker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UntargetedAttacker</span></code></a></p></td>
<td><p>Base class for adversarial non-targeted attack.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.untargeted.RandomAttack" title="greatx.attack.untargeted.RandomAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RandomAttack</span></code></a></p></td>
<td><p>Random attacker that randomly chooses edges to flip.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.untargeted.DICEAttack" title="greatx.attack.untargeted.DICEAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DICEAttack</span></code></a></p></td>
<td><p><p>Implementation of <cite>DICE</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1608.00375">&quot;Hiding Individuals and Communities in a Social Network&quot;</a> paper</p>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.untargeted.FGAttack" title="greatx.attack.untargeted.FGAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FGAttack</span></code></a></p></td>
<td><p><p>Implementation of <cite>FGA</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1809.02797">&quot;Fast Gradient Attack on Network Embedding&quot;</a> paper (arXiv'18)</p>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.untargeted.IGAttack" title="greatx.attack.untargeted.IGAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IGAttack</span></code></a></p></td>
<td><p><p>Implementation of <cite>IG-FGSM</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1903.01610">&quot;Adversarial Examples on Graph Data: Deep Insights into Attack and Defense&quot;</a> paper (IJCAI'19)</p>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.untargeted.Metattack" title="greatx.attack.untargeted.Metattack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Metattack</span></code></a></p></td>
<td><p>Implementation of <cite>Metattack</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1902.08412">&quot;Adversarial Attacks on Graph Neural Networks via Meta Learning&quot;</a> paper (ICLR'19)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.untargeted.MinmaxAttack" title="greatx.attack.untargeted.MinmaxAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MinmaxAttack</span></code></a></p></td>
<td><p>Implementation of <cite>MinMax</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1906.04214">&quot;Topology Attack and Defense for Graph Neural Networks: An Optimization Perspective&quot;</a> paper (IJCAI'19)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.untargeted.PGDAttack" title="greatx.attack.untargeted.PGDAttack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PGDAttack</span></code></a></p></td>
<td><p><p>Implementation of <cite>PGD</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/1906.04214">&quot;Topology Attack and Defense for Graph Neural Networks: An Optimization Perspective&quot;</a> paper (IJCAI'19)</p>
</p></td>
</tr>
</tbody>
</table>
<span class="target" id="module-greatx.attack.untargeted"></span><dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.untargeted.UntargetedAttacker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UntargetedAttacker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/untargeted_attacker.html#UntargetedAttacker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.UntargetedAttacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for adversarial non-targeted attack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.targeted.UntargetedAttacker</span></code> is a subclass of
<a class="reference internal" href="#greatx.attack.FlipAttacker" title="greatx.attack.FlipAttacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.FlipAttacker</span></code></a>.
It belongs to graph modification attack (GMA).</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.UntargetedAttacker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.untargeted.UntargetedAttacker" title="greatx.attack.untargeted.untargeted_attacker.UntargetedAttacker"><span class="pre">UntargetedAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/untargeted/untargeted_attacker.html#UntargetedAttacker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.UntargetedAttacker.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.untargeted.UntargetedAttacker" title="greatx.attack.untargeted.UntargetedAttacker">UntargetedAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.UntargetedAttacker.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.untargeted.UntargetedAttacker" title="greatx.attack.untargeted.untargeted_attacker.UntargetedAttacker"><span class="pre">UntargetedAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/untargeted/untargeted_attacker.html#UntargetedAttacker.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.UntargetedAttacker.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial untargeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id39"><span class="problematic" id="id40">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id41"><span class="problematic" id="id42">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.untargeted.RandomAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RandomAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/random_attack.html#RandomAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.RandomAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Random attacker that randomly chooses edges to flip.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.untargeted</span> <span class="kn">import</span> <span class="n">RandomAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">RandomAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># attack with 0.05% of edge perturbations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.RandomAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/random_attack.html#RandomAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.RandomAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial untargeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id43"><span class="problematic" id="id44">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id45"><span class="problematic" id="id46">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.RandomAttack.get_added_edge">
<span class="sig-name descname"><span class="pre">get_added_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influence_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/untargeted/random_attack.html#RandomAttack.get_added_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.RandomAttack.get_added_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.RandomAttack.get_removed_edge">
<span class="sig-name descname"><span class="pre">get_removed_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influence_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/untargeted/random_attack.html#RandomAttack.get_removed_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.RandomAttack.get_removed_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.untargeted.DICEAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DICEAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/dice_attack.html#DICEAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.DICEAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>DICE</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1608.00375">“Hiding Individuals and Communities in a Social
Network”</a> paper</p>
<p>DICE randomly chooses edges to flip based on the principle of
“Disconnect Internally, Connect Externally” (DICE),
which conducts attacks by removing edges between nodes
with high correlations and connecting edges with low correlations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.untargeted</span> <span class="kn">import</span> <span class="n">DICEAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">DICEAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># attack with 0.05% of edge perturbations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.DICEAttack.get_added_edge">
<span class="sig-name descname"><span class="pre">get_added_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influence_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/untargeted/dice_attack.html#DICEAttack.get_added_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.DICEAttack.get_added_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.DICEAttack.get_removed_edge">
<span class="sig-name descname"><span class="pre">get_removed_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influence_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/untargeted/dice_attack.html#DICEAttack.get_removed_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.DICEAttack.get_removed_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.untargeted.FGAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FGAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/fg_attack.html#FGAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.FGAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>FGA</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1809.02797">“Fast Gradient Attack on Network Embedding”</a> paper (arXiv’18)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.untargeted</span> <span class="kn">import</span> <span class="n">FGAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">FGAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># attack with 0.05% of edge perturbations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a simple but effective attack that utilizing gradient information
of the adjacency matrix. There are several work sharing the same heuristic,
we list them as follows:
[1] <cite>FGSM</cite>: <a class="reference external" href="https://arxiv.org/abs/1412.6572">“Explaining and Harnessing Adversarial Examples”</a> paper (ICLR’15)
[2] <a class="reference external" href="https://ieeexplore.ieee.org/abstract/document/9141291">“Link Prediction Adversarial Attack Via Iterative Gradient Attack”</a> paper (IEEE Trans’20)
[3] <a class="reference external" href="https://arxiv.org/abs/1806.02371">“Adversarial Attack on Graph Structured Data”</a> paper (ICML’18)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <a class="reference internal" href="#greatx.attack.untargeted.FGAttack.reset" title="greatx.attack.untargeted.FGAttack.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.FGAttack.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/fg_attack.html#FGAttack.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.FGAttack.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to initialize the (trained) surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>Module</em>) – the input surrogate module</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – temperature used for softmax activation, by default 1.0</p></li>
<li><p><strong>freeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to freeze the model’s parameters to save time, by default True</p></li>
<li><p><strong>required</strong> (<em>Union</em><em>[</em><em>Module</em><em>, </em><em>Tuple</em><em>[</em><em>Module</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – which class(es) of the surrogate model are required, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the class itself</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="root.html#greatx.surrogate.Surrogate" title="greatx.surrogate.Surrogate">Surrogate</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">required</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.FGAttack.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/fg_attack.html#FGAttack.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.FGAttack.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.untargeted.UntargetedAttacker" title="greatx.attack.untargeted.UntargetedAttacker">UntargetedAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.FGAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/fg_attack.html#FGAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.FGAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial untargeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id52"><span class="problematic" id="id53">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id54"><span class="problematic" id="id55">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.FGAttack.structure_score">
<span class="sig-name descname"><span class="pre">structure_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_grad</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/fg_attack.html#FGAttack.structure_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.FGAttack.structure_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.FGAttack.feature_score">
<span class="sig-name descname"><span class="pre">feature_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_grad</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/fg_attack.html#FGAttack.feature_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.FGAttack.feature_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.FGAttack.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modified_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/fg_attack.html#FGAttack.compute_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.FGAttack.compute_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IGAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>IG-FGSM</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1903.01610">“Adversarial Examples on Graph Data: Deep Insights
into Attack and Defense”</a> paper (IJCAI’19)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.untargeted</span> <span class="kn">import</span> <span class="n">IGAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">IGAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># attack with 0.05% of edge perturbations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>In the paper, <cite>IG-FGSM</cite> attack was implemented for targeted attack, we adapt the codes for the non-targeted attack here.</p></li>
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to initialize the (trained) surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>Module</em>) – the input surrogate module</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – temperature used for softmax activation, by default 1.0</p></li>
<li><p><strong>freeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to freeze the model’s parameters to save time, by default True</p></li>
<li><p><strong>required</strong> (<em>Union</em><em>[</em><em>Module</em><em>, </em><em>Tuple</em><em>[</em><em>Module</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – which class(es) of the surrogate model are required, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the class itself</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="root.html#greatx.surrogate.Surrogate" title="greatx.surrogate.Surrogate">Surrogate</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">required</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial untargeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id57"><span class="problematic" id="id58">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id59"><span class="problematic" id="id60">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack.get_link_importance">
<span class="sig-name descname"><span class="pre">get_link_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack.get_link_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack.get_link_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack.get_feature_importance">
<span class="sig-name descname"><span class="pre">get_feature_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack.get_feature_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack.get_feature_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack.structure_score">
<span class="sig-name descname"><span class="pre">structure_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_grad</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack.structure_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack.structure_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack.feature_score">
<span class="sig-name descname"><span class="pre">feature_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_grad</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack.feature_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack.feature_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack.compute_structure_gradients">
<span class="sig-name descname"><span class="pre">compute_structure_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack.compute_structure_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack.compute_structure_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.IGAttack.compute_feature_gradients">
<span class="sig-name descname"><span class="pre">compute_feature_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/ig_attack.html#IGAttack.compute_feature_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.IGAttack.compute_feature_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Metattack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>Metattack</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1902.08412">“Adversarial Attacks on Graph Neural Networks
via Meta Learning”</a> paper (ICLR’19)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.untargeted</span> <span class="kn">import</span> <span class="n">Metattack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">Metattack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># attack with 0.05% of edge perturbations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <a class="reference internal" href="#greatx.attack.untargeted.Metattack.reset" title="greatx.attack.untargeted.Metattack.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeled_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unlabeled_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to initialize the (trained) surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>Module</em>) – the input surrogate module</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – temperature used for softmax activation, by default 1.0</p></li>
<li><p><strong>freeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to freeze the model’s parameters to save time, by default True</p></li>
<li><p><strong>required</strong> (<em>Union</em><em>[</em><em>Module</em><em>, </em><em>Tuple</em><em>[</em><em>Module</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – which class(es) of the surrogate model are required, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the class itself</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="root.html#greatx.surrogate.Surrogate" title="greatx.surrogate.Surrogate">Surrogate</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">required</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.untargeted.UntargetedAttacker" title="greatx.attack.untargeted.UntargetedAttacker">UntargetedAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.get_perturbed_adj">
<span class="sig-name descname"><span class="pre">get_perturbed_adj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj_changes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.get_perturbed_adj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.get_perturbed_adj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.get_perturbed_feat">
<span class="sig-name descname"><span class="pre">get_perturbed_feat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_changes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.get_perturbed_feat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.get_perturbed_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.clip">
<span class="sig-name descname"><span class="pre">clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.clip" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.inner_train">
<span class="sig-name descname"><span class="pre">inner_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.inner_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.inner_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial untargeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id62"><span class="problematic" id="id63">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id64"><span class="problematic" id="id65">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.structure_score">
<span class="sig-name descname"><span class="pre">structure_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_grad</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.structure_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.structure_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.feature_score">
<span class="sig-name descname"><span class="pre">feature_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_grad</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.feature_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.feature_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.Metattack.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modified_adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modified_feat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/metattack.html#Metattack.compute_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.Metattack.compute_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.untargeted.MinmaxAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MinmaxAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#MinmaxAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.MinmaxAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>MinMax</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1906.04214">“Topology Attack and Defense for Graph Neural Networks:
An Optimization Perspective”</a> paper (IJCAI’19)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.untargeted</span> <span class="kn">import</span> <span class="n">MinmaxAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">MinmaxAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># attack with 0.05% of edge perturbations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>MinMax attack is a variant of <a class="reference internal" href="#greatx.attack.untargeted.PGDAttack" title="greatx.attack.untargeted.PGDAttack"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.untargeted.PGDAttack</span></code></a> attack.</p></li>
<li><p>Please remember to call <a class="reference internal" href="#greatx.attack.untargeted.MinmaxAttack.reset" title="greatx.attack.untargeted.MinmaxAttack.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.MinmaxAttack.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeled_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unlabeled_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#MinmaxAttack.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.MinmaxAttack.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to initialize the (trained) surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>Module</em>) – the input surrogate module</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – temperature used for softmax activation, by default 1.0</p></li>
<li><p><strong>freeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to freeze the model’s parameters to save time, by default True</p></li>
<li><p><strong>required</strong> (<em>Union</em><em>[</em><em>Module</em><em>, </em><em>Tuple</em><em>[</em><em>Module</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – which class(es) of the surrogate model are required, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the class itself</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="root.html#greatx.surrogate.Surrogate" title="greatx.surrogate.Surrogate">Surrogate</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">required</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.MinmaxAttack.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#MinmaxAttack.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.MinmaxAttack.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.untargeted.UntargetedAttacker" title="greatx.attack.untargeted.UntargetedAttacker">UntargetedAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.MinmaxAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CW_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#MinmaxAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.MinmaxAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial untargeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id67"><span class="problematic" id="id68">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id69"><span class="problematic" id="id70">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PGDAttack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>PGD</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/1906.04214">“Topology Attack and Defense for Graph Neural Networks:
An Optimization Perspective”</a> paper (IJCAI’19)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG-like data denoting the input graph</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the device of the attack running on, by default “cpu”</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the random seed for reproducing the attack, by default None</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – name of the attacker, if None, it would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">__class__.__name__</span></code>,
by default None</p></li>
<li><p><strong>kwargs</strong> (additional arguments of <a class="reference internal" href="#greatx.attack.Attacker" title="greatx.attack.Attacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.Attacker</span></code></a>,) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – unexpected keyword argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.untargeted</span> <span class="kn">import</span> <span class="n">PGDAttack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">PGDAttack</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># attack with 0.05% of edge perturbations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">edge_flips</span><span class="p">()</span> <span class="c1"># get edge flips after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">added_edges</span><span class="p">()</span> <span class="c1"># get added edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">removed_edges</span><span class="p">()</span> <span class="c1"># get removed edges after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>MinMax attack is a variant of <a class="reference internal" href="#greatx.attack.untargeted.PGDAttack" title="greatx.attack.untargeted.PGDAttack"><code class="xref py py-class docutils literal notranslate"><span class="pre">greatx.attack.untargeted.PGDAttack</span></code></a> attack.</p></li>
<li><p>Please remember to call <a class="reference internal" href="#greatx.attack.untargeted.PGDAttack.reset" title="greatx.attack.untargeted.PGDAttack.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeled_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unlabeled_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to initialize the (trained) surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>Module</em>) – the input surrogate module</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – temperature used for softmax activation, by default 1.0</p></li>
<li><p><strong>freeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to freeze the model’s parameters to save time, by default True</p></li>
<li><p><strong>required</strong> (<em>Union</em><em>[</em><em>Module</em><em>, </em><em>Tuple</em><em>[</em><em>Module</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – which class(es) of the surrogate model are required, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the class itself</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="root.html#greatx.surrogate.Surrogate" title="greatx.surrogate.Surrogate">Surrogate</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">required</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.untargeted.UntargetedAttacker" title="greatx.attack.untargeted.UntargetedAttacker">UntargetedAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CW_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_attack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial untargeted attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (int (0&lt;<a href="#id72"><span class="problematic" id="id73">`</span></a>num_budgets`&lt;=:attr:max_perturbations) or float (0&lt;<a href="#id74"><span class="problematic" id="id75">`</span></a>num_budgets`&lt;=1)) – <p>Case 1:
<cite>int</cite> : the number of attack budgets,
i.e., how many edges can be perturbed.</p>
<p>Case 2:
<cite>float</cite>: the number of attack budgets is
the ratio of :attr:max_perturbations</p>
<p>See <cite>:attr:max_perturbations</cite></p>
</p></li>
<li><p><strong>structure_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct structure attack, i.e., modify the graph structure (edges)</p></li>
<li><p><strong>feature_attack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to conduct feature attack, i.e., modify the node features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.config_C">
<span class="sig-name descname"><span class="pre">config_C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.config_C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.config_C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.bisection">
<span class="sig-name descname"><span class="pre">bisection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturbations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.bisection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.bisection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.get_perturbed_adj">
<span class="sig-name descname"><span class="pre">get_perturbed_adj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturbations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.get_perturbed_adj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.get_perturbed_adj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.projection">
<span class="sig-name descname"><span class="pre">projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturbations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.projection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.projection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.clip">
<span class="sig-name descname"><span class="pre">clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.clip" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.bernoulli_sample">
<span class="sig-name descname"><span class="pre">bernoulli_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturbations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.bernoulli_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.bernoulli_sample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturbations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.compute_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.untargeted.PGDAttack.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturbations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">victim_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/untargeted/pgd_attack.html#PGDAttack.compute_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.untargeted.PGDAttack.compute_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="injection-attacks">
<h2>Injection Attacks<a class="headerlink" href="#injection-attacks" title="Permalink to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.injection.InjectionAttacker" title="greatx.attack.injection.InjectionAttacker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InjectionAttacker</span></code></a></p></td>
<td><p>Base class for Injection Attacker, an inherent attack should implement the <cite>attack</cite> method.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.injection.RandomInjection" title="greatx.attack.injection.RandomInjection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RandomInjection</span></code></a></p></td>
<td><p>Injection nodes into a graph randomly.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.injection.AdvInjection" title="greatx.attack.injection.AdvInjection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AdvInjection</span></code></a></p></td>
<td><p>2nd place solution of KDD CUP 2020 &quot;Adversarial attack and defense&quot; challenge.</p></td>
</tr>
</tbody>
</table>
<span class="target" id="module-greatx.attack.injection"></span><dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InjectionAttacker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for Injection Attacker, an inherent attack should implement
the <cite>attack</cite> method.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">InjectionAttacker</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="go"># inject 10 nodes, where each nodes has 2 edges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">num_budgets</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_edges_local</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go"># inject 10 nodes, with 100 edges in total</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">num_budgets</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_edges_global</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go"># inject 10 nodes, where each nodes has 2 edges,</span>
<span class="go"># the features of injected nodes lies in [0,1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">num_budgets</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_edges_local</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feat_limits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">num_budgets</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_edges_local</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feat_limits</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="go"># inject 10 nodes, where each nodes has 2 edges,</span>
<span class="go"># the features of injected each node has 10 nonzero elements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">num_budgets</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_edges_local</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feat_budgets</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p># get injected nodes
&gt;&gt;&gt; attacker.injected_nodes()
# get injected edges
&gt;&gt;&gt; attacker.injected_edges()
# get injected nodes’ features
&gt;&gt;&gt; attacker.injected_feats()
# get perturbed graph
&gt;&gt;&gt; attacker.data()</p>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.injection.InjectionAttacker" title="greatx.attack.injection.injection_attacker.InjectionAttacker"><span class="pre">InjectionAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.injection.InjectionAttacker" title="greatx.attack.injection.InjectionAttacker">InjectionAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges_local</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_limits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.injection.InjectionAttacker" title="greatx.attack.injection.injection_attacker.InjectionAttacker"><span class="pre">InjectionAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial injection attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – the number/percentage of nodes allowed to inject</p></li>
<li><p><strong>targets</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>) – the targeted nodes where injected nodes perturb,
if None, it will be all nodes in the graph, by default None</p></li>
<li><p><strong>num_edges_global</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of total edges in the graph to be injected for
all injected nodes, by default None</p></li>
<li><p><strong>num_edges_local</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of edges allowed to inject for each injected nodes, by default None</p></li>
<li><p><strong>feat_limits</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>]</em><em>]</em><em>, </em><em>optional</em>) – the limitation or allowed budgets of injected node features,
it can be a tuple, e.g., <cite>(0, 1)</cite> or
a dict, e.g., <cite>{‘min’:0, ‘max’: 1}</cite>.
if None, it is set as (self.feat.min(), self.feat.max()), by default None</p></li>
<li><p><strong>feat_budgets</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of nonzero features can be injected for each node,
e.g., <cite>10</cite>, denoting 10 nonzero features can be injected, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>the attacker itself</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Both <cite>num_edges_local</cite> and <cite>num_edges_global</cite> cannot be used simultaneously.</p></li>
<li><p>Both <cite>feat_limits</cite> and <cite>feat_budgets</cite> cannot be used simultaneously.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.injected_nodes">
<span class="sig-name descname"><span class="pre">injected_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.injected_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.injected_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the nodes to be injected.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.added_nodes">
<span class="sig-name descname"><span class="pre">added_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.added_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.added_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of method <cite>added_nodes</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.injected_edges">
<span class="sig-name descname"><span class="pre">injected_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.injected_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.injected_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the edges to be injected.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.added_edges">
<span class="sig-name descname"><span class="pre">added_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.added_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.added_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of method <cite>injected_edges</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.edge_flips">
<span class="sig-name descname"><span class="pre">edge_flips</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="utils.html#greatx.utils.BunchDict" title="greatx.utils.bunchdict.BunchDict"><span class="pre">BunchDict</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.edge_flips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.edge_flips" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the edges to be flipped, including edges to be added and removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.injected_feats">
<span class="sig-name descname"><span class="pre">injected_feats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.injected_feats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.injected_feats" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the features injected nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.added_feats">
<span class="sig-name descname"><span class="pre">added_feats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.added_feats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.added_feats" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of method <cite>added_edges</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.inject_node">
<span class="sig-name descname"><span class="pre">inject_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.inject_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.inject_node" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.inject_edge">
<span class="sig-name descname"><span class="pre">inject_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.inject_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.inject_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Inject an edge to the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The source node of the edge.</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The destination node of the edge.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.inject_edges">
<span class="sig-name descname"><span class="pre">inject_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.inject_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.inject_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Inject a set of edges to the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edges</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>List</em><em>]</em>) – The newly injected.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.inject_feat">
<span class="sig-name descname"><span class="pre">inject_feat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.inject_feat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.inject_feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate  a feature vector to the graph for a newly
injected node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>feat</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>the injected feature. If None, it would be randomly generated,</dt><dd><p>by default None</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.InjectionAttacker.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Data</span></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/injection_attacker.html#InjectionAttacker.data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.InjectionAttacker.data" title="Permalink to this definition">¶</a></dt>
<dd><p>return the attacked graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>symmetric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Determine whether the resulting graph is forcibly symmetric</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the attacked graph represented as PyG-like data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.injection.RandomInjection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RandomInjection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/injection/random_injection.html#RandomInjection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.RandomInjection" title="Permalink to this definition">¶</a></dt>
<dd><p>Injection nodes into a graph randomly.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.injection</span> <span class="kn">import</span> <span class="n">RandomInjection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">RandomInjection</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">feat_limits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># injecting 10 nodes for continuous features</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">feat_budgets</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># injecting 10 nodes for binary features</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">injected_nodes</span><span class="p">()</span> <span class="c1"># get injected nodes after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">injected_edges</span><span class="p">()</span> <span class="c1"># get injected edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">injected_feats</span><span class="p">()</span> <span class="c1"># get injected features after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.RandomInjection.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interconnection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges_local</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_limits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.injection.RandomInjection" title="greatx.attack.injection.random_injection.RandomInjection"><span class="pre">RandomInjection</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/random_injection.html#RandomInjection.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.RandomInjection.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial injection attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – the number/percentage of nodes allowed to inject</p></li>
<li><p><strong>targets</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>) – the targeted nodes where injected nodes perturb,
if None, it will be all nodes in the graph, by default None</p></li>
<li><p><strong>interconnection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether the injected nodes can connect to each other, by default False</p></li>
<li><p><strong>num_edges_global</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of total edges in the graph to be injected for
all injected nodes, by default None</p></li>
<li><p><strong>num_edges_local</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of edges allowed to inject for each injected nodes, by default None</p></li>
<li><p><strong>feat_limits</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>]</em><em>]</em><em>, </em><em>optional</em>) – the limitation or allowed budgets of injected node features,
it can be a tuple, e.g., <cite>(0, 1)</cite> or
a dict, e.g., <cite>{‘min’:0, ‘max’: 1}</cite>.
if None, it is set as (self.feat.min(), self.feat.max()), by default None</p></li>
<li><p><strong>feat_budgets</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of nonzero features can be injected for each node,
e.g., <cite>10</cite>, denoting 10 nonzero features can be injected, by default None</p></li>
<li><p><strong>disable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether the tqdm progbar is to disabled, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>the attacker itself</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Both <cite>num_edges_local</cite> and <cite>num_edges_global</cite> cannot be used simultaneously.</p></li>
<li><p>Both <cite>feat_limits</cite> and <cite>feat_budgets</cite> cannot be used simultaneously.</p></li>
</ul>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.injection.AdvInjection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AdvInjection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/injection/adv_injection.html#AdvInjection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.AdvInjection" title="Permalink to this definition">¶</a></dt>
<dd><p>2nd place solution of KDD CUP 2020
“Adversarial attack and defense” challenge.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.injection</span> <span class="kn">import</span> <span class="n">AdvInjection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">AdvInjection</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">feat_limits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># injecting 10 nodes for continuous features</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">feat_budgets</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># injecting 10 nodes for binary features</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">injected_nodes</span><span class="p">()</span> <span class="c1"># get injected nodes after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">injected_edges</span><span class="p">()</span> <span class="c1"># get injected edges after attack</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">injected_feats</span><span class="p">()</span> <span class="c1"># get injected features after attack</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.AdvInjection.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interconnection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges_local</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_limits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.injection.AdvInjection" title="greatx.attack.injection.adv_injection.AdvInjection"><span class="pre">AdvInjection</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/injection/adv_injection.html#AdvInjection.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.AdvInjection.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial injection attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_budgets</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – the number/percentage of nodes allowed to inject</p></li>
<li><p><strong>targets</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>) – the targeted nodes where injected nodes perturb,
if None, it will be all nodes in the graph, by default None</p></li>
<li><p><strong>num_edges_global</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of total edges in the graph to be injected for
all injected nodes, by default None</p></li>
<li><p><strong>num_edges_local</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of edges allowed to inject for each injected nodes, by default None</p></li>
<li><p><strong>feat_limits</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>]</em><em>]</em><em>, </em><em>optional</em>) – the limitation or allowed budgets of injected node features,
it can be a tuple, e.g., <cite>(0, 1)</cite> or
a dict, e.g., <cite>{‘min’:0, ‘max’: 1}</cite>.
if None, it is set as (self.feat.min(), self.feat.max()), by default None</p></li>
<li><p><strong>feat_budgets</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the number of nonzero features can be injected for each node,
e.g., <cite>10</cite>, denoting 10 nonzero features can be injected, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>the attacker itself</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Both <cite>num_edges_local</cite> and <cite>num_edges_global</cite> cannot be used simultaneously.</p></li>
<li><p>Both <cite>feat_limits</cite> and <cite>feat_budgets</cite> cannot be used simultaneously.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.injection.AdvInjection.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injected_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injected_edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injected_edge_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/injection/adv_injection.html#AdvInjection.compute_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.injection.AdvInjection.compute_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="backdoor-attacks">
<h2>Backdoor Attacks<a class="headerlink" href="#backdoor-attacks" title="Permalink to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.backdoor.BackdoorAttacker" title="greatx.attack.backdoor.BackdoorAttacker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BackdoorAttacker</span></code></a></p></td>
<td><p>Base class for backdoor attacks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#greatx.attack.backdoor.FGBackdoor" title="greatx.attack.backdoor.FGBackdoor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FGBackdoor</span></code></a></p></td>
<td><p>Implementation of <cite>GB-FGSM</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/2201.06202">&quot;Neighboring Backdoor Attacks on Graph Convolutional Network&quot;</a> paper (arXiv'22)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#greatx.attack.backdoor.LGCBackdoor" title="greatx.attack.backdoor.LGCBackdoor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LGCBackdoor</span></code></a></p></td>
<td><p><p>Implementation of <cite>LGCB</cite> attack from the: <a class="reference external" href="https://arxiv.org/abs/2201.06202">&quot;Neighboring Backdoor Attacks on Graph Convolutional Network&quot;</a> paper (arXiv'22)</p>
</p></td>
</tr>
</tbody>
</table>
<span class="target" id="module-greatx.attack.backdoor"></span><dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.backdoor.BackdoorAttacker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BackdoorAttacker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/backdoor/backdoor_attacker.html#BackdoorAttacker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.BackdoorAttacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for backdoor attacks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.BackdoorAttacker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.backdoor.BackdoorAttacker" title="greatx.attack.backdoor.backdoor_attacker.BackdoorAttacker"><span class="pre">BackdoorAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/backdoor_attacker.html#BackdoorAttacker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.BackdoorAttacker.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the Attacker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the attacker itself</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#greatx.attack.backdoor.BackdoorAttacker" title="greatx.attack.backdoor.BackdoorAttacker">BackdoorAttacker</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.BackdoorAttacker.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.backdoor.BackdoorAttacker" title="greatx.attack.backdoor.backdoor_attacker.BackdoorAttacker"><span class="pre">BackdoorAttacker</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/backdoor_attacker.html#BackdoorAttacker.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.BackdoorAttacker.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial backdoor attack</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.BackdoorAttacker.trigger">
<span class="sig-name descname"><span class="pre">trigger</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/backdoor_attacker.html#BackdoorAttacker.trigger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.BackdoorAttacker.trigger" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.BackdoorAttacker.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Data</span></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/backdoor_attacker.html#BackdoorAttacker.data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.BackdoorAttacker.data" title="Permalink to this definition">¶</a></dt>
<dd><p>return the attacked graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_node</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the target node that the attack performed</p></li>
<li><p><strong>symmetric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – determine whether the resulting graph is forcibly symmetric,
by default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the attacked graph with backdoor attack performed on the target node</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.backdoor.FGBackdoor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FGBackdoor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/backdoor/lgc_backdoor.html#FGBackdoor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.FGBackdoor" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>GB-FGSM</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/2201.06202">“Neighboring Backdoor Attacks on Graph Convolutional Network”</a> paper (arXiv’22)</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.backdoor</span> <span class="kn">import</span> <span class="n">FGBackdoor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">FGBackdoor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">num_budgets</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">target_class</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span> <span class="c1"># get trigger node</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.FGBackdoor.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.backdoor.FGBackdoor" title="greatx.attack.backdoor.lgc_backdoor.FGBackdoor"><span class="pre">FGBackdoor</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/lgc_backdoor.html#FGBackdoor.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.FGBackdoor.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to initialize the (trained) surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>Module</em>) – the input surrogate module</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – temperature used for softmax activation, by default 1.0</p></li>
<li><p><strong>freeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to freeze the model’s parameters to save time, by default True</p></li>
<li><p><strong>required</strong> (<em>Union</em><em>[</em><em>Module</em><em>, </em><em>Tuple</em><em>[</em><em>Module</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – which class(es) of the surrogate model are required, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the class itself</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="root.html#greatx.surrogate.Surrogate" title="greatx.surrogate.Surrogate">Surrogate</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the surrogate model is not an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">required</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.FGBackdoor.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.backdoor.FGBackdoor" title="greatx.attack.backdoor.lgc_backdoor.FGBackdoor"><span class="pre">FGBackdoor</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/lgc_backdoor.html#FGBackdoor.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.FGBackdoor.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial backdoor attack</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="greatx.attack.backdoor.LGCBackdoor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LGCBackdoor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/greatx/attack/backdoor/lgc_backdoor.html#LGCBackdoor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.LGCBackdoor" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <cite>LGCB</cite> attack from the:
<a class="reference external" href="https://arxiv.org/abs/2201.06202">“Neighboring Backdoor Attacks on Graph Convolutional Network”</a> paper (arXiv’22)</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.dataset</span> <span class="kn">import</span> <span class="n">GraphDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch_geometric.transforms</span> <span class="k">as</span> <span class="nn">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data/pygdata&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span>
<span class="go">                      transform=T.LargestConnectedComponents())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_model</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># train your surrogate model</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">greatx.attack.backdoor</span> <span class="kn">import</span> <span class="n">LGCBackdoor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">setup_surrogate</span><span class="p">(</span><span class="n">surrogate_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span> <span class="o">=</span> <span class="n">LGCBackdoor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">num_budgets</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">target_class</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="c1"># get attacked graph</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attacker</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span> <span class="c1"># get trigger node</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Please remember to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code> before each attack.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.LGCBackdoor.setup_surrogate">
<span class="sig-name descname"><span class="pre">setup_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.backdoor.LGCBackdoor" title="greatx.attack.backdoor.LGCBackdoor"><span class="pre">LGCBackdoor</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/lgc_backdoor.html#LGCBackdoor.setup_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.LGCBackdoor.setup_surrogate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.LGCBackdoor.attack">
<span class="sig-name descname"><span class="pre">attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#greatx.attack.backdoor.LGCBackdoor" title="greatx.attack.backdoor.lgc_backdoor.LGCBackdoor"><span class="pre">LGCBackdoor</span></a></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/lgc_backdoor.html#LGCBackdoor.attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.LGCBackdoor.attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Base method that describes the adversarial backdoor attack</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="greatx.attack.backdoor.LGCBackdoor.get_feat_perturbations">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_feat_perturbations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_budgets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/greatx/attack/backdoor/lgc_backdoor.html#LGCBackdoor.get_feat_perturbations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#greatx.attack.backdoor.LGCBackdoor.get_feat_perturbations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dataset.html" class="btn btn-neutral float-left" title="greatx.dataset" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="defense.html" class="btn btn-neutral float-right" title="greatx.defense" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Jintang Li.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>